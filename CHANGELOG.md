# 更新日志

## [v1.1.0] - 骰子判定系统 - 2024

### ✨ 新增功能

#### 🎲 骰子判定系统
- 实现完整的2D6骰子判定机制
- 5种判定结果：大失败、失败、成功、完美成功、大成功
- 特质加成系统：角色特质影响判定结果（每个特质+2到+4）
- 动画效果：精美的骰子滚动和结果展示动画
- AI智能识别：自动识别需要判定的高风险场景

#### 🎯 判定场景
- **战斗场景**：攻击、防御、闪避、格挡
- **社交场景**：说服、威胁、欺骗、谈判
- **技能场景**：潜行、侦查、破解、追踪
- **危险场景**：跳跃、攀爬、逃跑、冒险行动

#### 💡 用户体验优化
- 选项上显示🎲图标标识需要判定
- 显示难度等级（简单/普通/困难/极难）
- 显示骰子点数、特质加成和最终结果
- AI根据判定结果生成相应剧情
- 判定历史记录保存

### 📦 技术实现

#### 新增文件
- `lib/dice-engine.ts` - 骰子引擎核心逻辑
- `components/dice-roller.tsx` - 骰子动画组件
- `DICE_SYSTEM.md` - 骰子系统使用文档

#### 更新文件
- `lib/types.ts` - 添加DiceRoll和Choice接口
- `lib/prompt-templates.ts` - 更新AI prompt支持骰子判定
- `lib/ai-service.ts` - 集成骰子结果到AI生成
- `store/game-store.ts` - 添加骰子状态管理
- `components/choice-buttons.tsx` - 支持结构化选项和骰子图标
- `app/game/page.tsx` - 集成骰子判定流程

### 🎨 UI/UX改进
- 需要判定的选项使用紫色渐变高亮
- 骰子滚动动画使用Framer Motion
- 判定结果使用颜色和emoji直观展示
- 难度信息显示在选项下方

### 🔧 系统优化
- 向后兼容：支持简单字符串选项和结构化Choice对象
- 容错机制：如果AI不提供难度，自动推测
- 关键词检测：自动识别需要判定的动作
- 特质智能匹配：根据选项内容推荐相关特质

---

## [v1.0.0] - 初始发布

### ✨ 核心功能

#### 📖 互动故事系统
- AI动态生成永不重复的故事
- 3种题材：武侠江湖、都市灵异、浴血黑帮
- 角色创建：自定义名字和3个特质
- 选择系统：3个预设选项 + 自定义输入

#### 🤖 AI集成
- 支持OpenRouter (DeepSeek V3, Qwen 2.5 7B)
- 支持通义千问、智谱GLM、文心一言
- 高质量中文剧情生成
- 角色特质影响剧情走向

#### 💾 数据管理
- 自动保存游戏进度
- localStorage本地存储
- 多存档支持
- 历史记录查看

#### 🎨 用户界面
- 深色主题，护眼设计
- 打字机效果展示剧情
- Framer Motion动画
- 响应式设计，移动端友好

#### 📊 游戏统计
- 章节数统计
- 决策次数统计
- 游玩时长统计
- 角色特质展示

---

## 未来计划

### v1.2.0 (计划中)
- [ ] 多人协作模式
- [ ] 更多题材（赛博朋克、克苏鲁）
- [ ] 成就系统
- [ ] 剧情分支可视化

### v1.3.0 (考虑中)
- [ ] 语音朗读
- [ ] 配乐系统
- [ ] 插画生成
- [ ] 云端同步

